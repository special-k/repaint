(function(){var t,e,r,n,s,o,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};glob.Repaint=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.addManager("itemsManager",new r),document.body.append(this.div({id:"app"},function(){return this.list()}))}return i(e,t),e}(RT.Stratum),r=function(t){function e(){}var r;return i(e,t),r="todos-redtea",e.prototype.render=function(){var t,e,r,n,s,o,a,i,u,p,c,l,m,d,g,h;if(t=ENV.generateData().toArray(),0===this.storageItems.count())for(u=0,l=t.length;l>u;u++)e=t[u],this.storageItems.push(new RT.StorageItem(e));else for(g=this.storageItems.items,r=p=0,m=g.length;m>p;r=++p)for(n=g[r],e=t[r],n.get("dbnames").first().set("dbname",e.dbname),a=n.get("queryCount").first(),a.set("countClassName",e.lastSample.countClassName),a.set("nbQueries",e.lastSample.nbQueries),h=e.lastSample.topFiveQueries,s=c=0,d=h.length;d>c;s=++c)o=h[s],i=n.get("topQuery").items[s],i.set("elapsedClassName",o.elapsedClassName),i.set("formatElapsed",o.formatElapsed),i.set("query",o.query);return Monitoring.renderRate.ping(),setTimeout(function(t){return function(){return t.render()}}(this),ENV.timeout)},e.prototype.setStorageItems=function(t){return this.storageItems=t,this.render()},e}(RT.BaseManager),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.register("list"),e.prototype.managers=["itemsManager"],e.prototype.itemsManagerLoaded=function(){return this.itemsManager.setStorageItems(this.getCollectionField("items"))},e.prototype.createDom=function(t){return this.table({"class":"table table-striped latest-data"},function(){return this.tbody().setas("tbodyEl",t)})},e.prototype.append=function(t,e){return this.addHelper(this.tbodyEl,t,e)},e.prototype.storageInit=function(){return this.bime(this.getCollectionField("items"),"onItemAdded","onItemAdded")},e.prototype.onItemAdded=function(t,e){return null==e.widget?this.append(function(){return this.item({storageItem:e})}):void 0},e}(RT.Widget),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return i(e,t),r="topQuery",e.register("item"),e.prototype.collectionName="items",e.prototype.createDom=function(t){return this.tr(function(){var e,r,n;for(this.dbname({storageData:t.storageItem.data}),this.queryCount({storageData:t.storageItem.get("lastSample")}),n=[],e=r=0;4>=r;e=++r)n.push(this.topQuery({storageData:t.storageItem.get("lastSample").topFiveQueries[e]||{}}));return n})},e}(RT.Widget),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return i(e,t),r="dbname",e.register(r),e.prototype.collectionName="dbnames",e.prototype.storageInit=function(){return this.bime(this.storageItem,"onFieldChanged","onFieldChanged")},e.prototype.createDom=function(t){return this.td({"class":r},function(){return this.tn(t.storageItem.get(r)).setas("nameEl",t)})},e.prototype.onFieldChanged=function(t,e,n){switch(e){case r:return this.nameEl.animNodeValue(n)}},e}(RT.Widget),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r,n,s;return i(e,t),s="queryCount",r="countClassName",n="nbQueries",e.register(s),e.prototype.collectionName=s,e.prototype.storageInit=function(){return this.bime(this.storageItem,"onFieldChanged","onFieldChanged")},e.prototype.createDom=function(t){return this.td({"class":"query-count"},function(){return this.span().setas("spanEl",t).append(function(){return this.tn("").setas("countEl",t)})})},e.prototype.onFieldChanged=function(t,e,s){switch(e){case r:return this.spanEl.animClassName(s);case n:return this.countEl.animNodeValue(s)}},e}(RT.Widget),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r,n,s,o;return i(e,t),o="topQuery",r="elapsedClassName",n="formatElapsed",s="query",e.register(o),e.prototype.collectionName=o,e.prototype.storageInit=function(){return this.bime(this.storageItem,"onFieldChanged","onFieldChanged")},e.prototype.createDom=function(t,e){return this.td({"class":t.storageItem.get(r)}).setas("elapsedClassName",t).append(function(){return this.tn(t.storageItem.get(n)).setas("formatElapsedEl",t),this.div({"class":"popover left"},function(){return this.div({"class":"popover-content"},function(){return this.tn(t.storageItem.get(s)).setas("queryEl",t)}),this.div({"class":"arrow"})})})},e.prototype.onFieldChanged=function(t,e,o){switch(e){case r:return this.elapsedClassName.animClassName(o);case n:return this.formatElapsedEl.animNodeValue(o);case s:return this.queryEl.animNodeValue(o)}},e}(RT.Widget)}).call(this);
